# Security headers for all locations
map $sent_http_content_type $security_headers {
    default                                 "${headers}security.txt";
    "~*text/html"                          "${headers}security.html";
    "~*application/json"                   "${headers}security.api";
}

# Common security headers
map $security_headers $headers {
    default "
        add_header Strict-Transport-Security 'max-age=31536000; includeSubDomains' always;
        add_header X-Frame-Options 'SAMEORIGIN' always;
        add_header X-Content-Type-Options 'nosniff' always;
        add_header X-XSS-Protection '1; mode=block' always;
        add_header Referrer-Policy 'strict-origin-when-cross-origin' always;
        add_header Permissions-Policy 'camera=(), microphone=(), geolocation=()' always;
        add_header Content-Security-Policy \"default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: wss: https:; frame-ancestors 'self'\" always;
    ";
}