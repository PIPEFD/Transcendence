# API Proxy Configuration
location /api/ {
    # Remove the /api/ prefix before passing to backend
    rewrite ^/api/(.*)$ /$1 break;
    
    # Pass requests to backend service
    proxy_pass http://backend:${BACKEND_PORT};
    
    # Include common proxy headers
    include /etc/nginx/snippets/proxy_common.conf;
    
    # Timeouts
    proxy_connect_timeout 300;
    proxy_send_timeout 300;
    proxy_read_timeout 300;
    
    # Rate limiting for API
    limit_req zone=api_limit burst=20 nodelay;
}